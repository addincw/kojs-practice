<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>List and Collection | Knockout JS Practice</title>
  </head>
  <body>
    <h1>Your Seat Reservations</h1>

    <button data-bind="click: reserveRandomSeat" style="margin-bottom: 16px">
      Reserve Random Seat
    </button>

    <table border="1">
      <thead>
        <tr>
          <th>Passenger Name</th>
          <th>Meal</th>
          <th>Surcharge</th>
        </tr>
      </thead>
      <tbody data-bind="foreach: seats">
        <tr>
          <td data-bind="text: name"></td>
          <td data-bind="text: meal()?.name"></td>
          <td data-bind="text: meal()?.price"></td>
        </tr>
      </tbody>
    </table>

    <script src="/assets/knockout-3.5.1.js"></script>
    <script type="text/javascript">
      // model
      function Seat(name = "", meal = {}) {
        var self = this;

        self.name = name;
        self.meal = ko.observable(meal);
      }

      function ReservationViewModel() {
        var self = this;

        self.meals = [
          { name: "Standart (sandwich)", price: 0 },
          { name: "Premium (lobster)", price: 34.95 },
          { name: "Ultimate (whole zebra)", price: 290 },
        ];

        self.seats = ko.observableArray([]);

        self.reserveRandomSeat = function () {
          const randomName = (Math.random() + 1).toString(36).substring(7);
          const randomMealIdx = Math.floor(Math.random() * 3);

          self.seats.push(new Seat(randomName, self.meals[randomMealIdx]));
        };
      }

      ko.applyBindings(new ReservationViewModel());
    </script>
  </body>
</html>
